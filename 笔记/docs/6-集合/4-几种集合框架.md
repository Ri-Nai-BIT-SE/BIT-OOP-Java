# Java é›†åˆæ¡†æ¶ç¬”è®°

Java æä¾›äº†ä¸€å¥—å¼ºå¤§çš„é›†åˆæ¡†æ¶ï¼ˆJava Collections Frameworkï¼‰ï¼Œç”¨äºå­˜å‚¨å’Œæ“ä½œä¸€ç»„å¯¹è±¡ã€‚ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹æ ¸å¿ƒæ¥å£åŠå…¶å®ç°ç±»ï¼š

- `List`ï¼šæœ‰åºã€å¯é‡å¤
- `Set`ï¼šæ— åºã€ä¸å¯é‡å¤
- `Map`ï¼šé”®å€¼å¯¹æ˜ å°„

ä¸‹é¢æˆ‘ä»¬åˆ†åˆ«ä»‹ç»å®ƒä»¬çš„ä¸»è¦å®ç°ç±»åŠå…¶å¸¸ç”¨æ–¹æ³•å’Œç¤ºä¾‹ã€‚



## ä¸€ã€`List` æ¥å£ï¼šæœ‰åºã€å¯é‡å¤é›†åˆ

### å¸¸ç”¨å®ç°ç±»ï¼š
- `ArrayList`
- `LinkedList`


### âœ… `ArrayList`ï¼šåŸºäºåŠ¨æ€æ•°ç»„çš„çº¿æ€§è¡¨

#### ç‰¹ç‚¹ï¼š
- æ”¯æŒå¿«é€Ÿéšæœºè®¿é—®ï¼ˆO(1)ï¼‰
- æ’å…¥/åˆ é™¤æ•ˆç‡è¾ƒä½ï¼ˆO(n)ï¼Œé™¤éåœ¨æœ«å°¾ï¼‰
- çº¿ç¨‹ä¸å®‰å…¨

#### å¸¸ç”¨æ–¹æ³•ä¸ç¤ºä¾‹ï¼š

| æ–¹æ³• | æè¿° |
|------|------|
| `boolean add(E e)` | æ·»åŠ å…ƒç´ åˆ°æœ«å°¾ |
| `void add(int index, E element)` | åœ¨æŒ‡å®šä½ç½®æ’å…¥å…ƒç´  |
| `E get(int index)` | è·å–æŒ‡å®šç´¢å¼•å¤„çš„å…ƒç´  |
| `E set(int index, E element)` | æ›¿æ¢æŒ‡å®šç´¢å¼•å¤„çš„å…ƒç´ å¹¶è¿”å›æ—§å€¼ |
| `E remove(int index)` | åˆ é™¤æŒ‡å®šç´¢å¼•å¤„çš„å…ƒç´ å¹¶è¿”å›è¯¥å…ƒç´  |
| `int size()` | è¿”å›å½“å‰å…ƒç´ æ•°é‡ |
| `void ensureCapacity(int minCapacity)` | æ‰‹åŠ¨æ‰©å®¹å†…éƒ¨æ•°ç»„ |
| `void trimToSize()` | å°†åº•å±‚æ•°ç»„å¤§å°è°ƒæ•´ä¸ºå½“å‰å®é™…å…ƒç´ æ•°é‡ |

```java
ArrayList<String> list = new ArrayList<>();
list.add("A");
list.add(0, "B"); // æ’å…¥åˆ°ç´¢å¼•0
System.out.println(list.get(1)); // è¾“å‡º A
list.set(0, "C");
list.remove(1);
System.out.println(list.size()); // è¾“å‡º 1

list.ensureCapacity(100); // æ‰‹åŠ¨æ‰©å®¹
list.trimToSize(); // èŠ‚çœå†…å­˜
```


### âœ… `LinkedList`ï¼šåŸºäºåŒå‘é“¾è¡¨çš„çº¿æ€§è¡¨

#### ç‰¹ç‚¹ï¼š
- æ’å…¥/åˆ é™¤æ•ˆç‡é«˜ï¼ˆO(1)ï¼Œå·²çŸ¥èŠ‚ç‚¹ä½ç½®ï¼‰
- ä¸æ”¯æŒå¿«é€Ÿéšæœºè®¿é—®ï¼ˆO(n)ï¼‰
- å¯ä½œä¸ºæ ˆã€é˜Ÿåˆ—æˆ–åŒç«¯é˜Ÿåˆ—ä½¿ç”¨
- çº¿ç¨‹ä¸å®‰å…¨

#### å¸¸ç”¨æ–¹æ³•ä¸ç¤ºä¾‹ï¼š

| æ–¹æ³• | æè¿° |
|------|------|
| `void addFirst(E e)` | åœ¨é“¾è¡¨å¤´éƒ¨æ’å…¥å…ƒç´  |
| `void addLast(E e)` | åœ¨é“¾è¡¨å°¾éƒ¨æ’å…¥å…ƒç´  |
| `E getFirst()` | è·å–é“¾è¡¨ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆä¸åˆ é™¤ï¼‰ |
| `E getLast()` | è·å–é“¾è¡¨æœ€åä¸€ä¸ªå…ƒç´ ï¼ˆä¸åˆ é™¤ï¼‰ |
| `E removeFirst()` | åˆ é™¤å¹¶è¿”å›é“¾è¡¨ç¬¬ä¸€ä¸ªå…ƒç´  |
| `E removeLast()` | åˆ é™¤å¹¶è¿”å›é“¾è¡¨æœ€åä¸€ä¸ªå…ƒç´  |

```java
LinkedList<Integer> list = new LinkedList<>();
list.addFirst(1);
list.addLast(2);
System.out.println(list.getFirst()); // è¾“å‡º 1
System.out.println(list.removeLast()); // è¾“å‡º 2
```


## äºŒã€`Set` æ¥å£ï¼šæ— åºã€ä¸å¯é‡å¤é›†åˆ

### å¸¸ç”¨å®ç°ç±»ï¼š
- `HashSet`
- `LinkedHashSet`
- `TreeSet`


### âœ… `HashSet`ï¼šåŸºäºå“ˆå¸Œè¡¨çš„æ— åºé›†åˆ

#### ç‰¹ç‚¹ï¼š
- å…ƒç´ æ— åº
- æ’å…¥ã€æŸ¥æ‰¾æ•ˆç‡æ¥è¿‘ O(1)
- å…è®¸ null å…ƒç´ 
- çº¿ç¨‹ä¸å®‰å…¨

#### å¸¸ç”¨æ–¹æ³•ä¸ç¤ºä¾‹ï¼š

| æ–¹æ³• | æè¿° |
|------|------|
| `boolean add(E e)` | æ·»åŠ å…ƒç´ ï¼Œè‹¥å·²å­˜åœ¨åˆ™ä¸æ·»åŠ  |
| `boolean remove(Object o)` | åˆ é™¤æŒ‡å®šå…ƒç´  |
| `boolean contains(Object o)` | åˆ¤æ–­æ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´  |
| `int size()` | è¿”å›é›†åˆä¸­å…ƒç´ æ•°é‡ |

```java
HashSet<String> set = new HashSet<>();
set.add("Java");
set.add("Python");
System.out.println(set.contains("Java")); // true
set.remove("Python");
System.out.println(set.size()); // è¾“å‡º 1
```


### âœ… `LinkedHashSet`ï¼šä¿ç•™æ’å…¥é¡ºåºçš„ Set

#### ç‰¹ç‚¹ï¼š
- ç»§æ‰¿è‡ª `HashSet`
- ä½¿ç”¨åŒå‘é“¾è¡¨ç»´æŠ¤æ’å…¥é¡ºåº
- æ’å…¥æ€§èƒ½ç•¥ä½äº `HashSet`

#### å¸¸ç”¨æ–¹æ³•ä¸ç¤ºä¾‹ï¼š

| æ–¹æ³• | æè¿° |
|------|------|
| `Iterator<E> iterator()` | æŒ‰æ’å…¥é¡ºåºéå†é›†åˆ |

```java
LinkedHashSet<String> set = new LinkedHashSet<>();
set.add("A");
set.add("B");
for (String s : set) {
    System.out.print(s + " "); // è¾“å‡º A B
}
```


### âœ… `TreeSet`ï¼šåŸºäºçº¢é»‘æ ‘çš„æœ‰åºé›†åˆ

#### ç‰¹ç‚¹ï¼š
- å…ƒç´ é»˜è®¤æŒ‰è‡ªç„¶é¡ºåºæ’åºï¼ˆå‡åºï¼‰
- æ’å…¥ã€æŸ¥æ‰¾ã€åˆ é™¤æ—¶é—´å¤æ‚åº¦ä¸º O(log n)
- ä¸å…è®¸ null å…ƒç´ 
- çº¿ç¨‹ä¸å®‰å…¨

#### å¸¸ç”¨æ–¹æ³•ä¸ç¤ºä¾‹ï¼š

| æ–¹æ³• | æè¿° |
|------|------|
| `E first()` | è¿”å›é›†åˆä¸­çš„ç¬¬ä¸€ä¸ªï¼ˆæœ€å°ï¼‰å…ƒç´  |
| `E last()` | è¿”å›é›†åˆä¸­çš„æœ€åä¸€ä¸ªï¼ˆæœ€å¤§ï¼‰å…ƒç´  |
| `SortedSet<E> headSet(E toElement)` | è¿”å›å°äº `toElement` çš„æ‰€æœ‰å…ƒç´ ç»„æˆçš„å­é›† |
| `SortedSet<E> tailSet(E fromElement)` | è¿”å›å¤§äºç­‰äº `fromElement` çš„æ‰€æœ‰å…ƒç´ ç»„æˆçš„å­é›† |

```java
TreeSet<Integer> set = new TreeSet<>();
set.add(3);
set.add(1);
set.add(2);

System.out.println(set.first()); // è¾“å‡º 1
System.out.println(set.last());  // è¾“å‡º 3
System.out.println(set.headSet(2)); // è¾“å‡º [1]
```


## ä¸‰ã€`Map` æ¥å£ï¼šé”®å€¼å¯¹é›†åˆ

### å¸¸ç”¨å®ç°ç±»ï¼š
- `HashMap`
- `LinkedHashMap`
- `TreeMap`
- `Hashtable`


### âœ… `HashMap`ï¼šåŸºäºå“ˆå¸Œè¡¨çš„é”®å€¼å¯¹é›†åˆ

#### ç‰¹ç‚¹ï¼š
- é”®å’Œå€¼éƒ½å¯ä»¥ä¸º null
- æ— åºï¼ˆæ’å…¥é¡ºåº â‰  å­˜å‚¨é¡ºåºï¼‰
- æ’å…¥ã€æŸ¥æ‰¾æ•ˆç‡æ¥è¿‘ O(1)
- çº¿ç¨‹ä¸å®‰å…¨

#### å¸¸ç”¨æ–¹æ³•ä¸ç¤ºä¾‹ï¼š

| æ–¹æ³• | æè¿° |
|------|------|
| `V put(K key, V value)` | æ·»åŠ æˆ–æ›´æ–°é”®å€¼å¯¹ |
| `V get(Object key)` | æ ¹æ®é”®è·å–å¯¹åº”çš„å€¼ |
| `V remove(Object key)` | æ ¹æ®é”®åˆ é™¤é”®å€¼å¯¹å¹¶è¿”å›å¯¹åº”å€¼ |
| `boolean containsKey(Object key)` | åˆ¤æ–­æ˜¯å¦åŒ…å«æŒ‡å®šé”® |
| `Set<K> keySet()` | è¿”å›æ‰€æœ‰é”®çš„é›†åˆ |
| `Collection<V> values()` | è¿”å›æ‰€æœ‰å€¼çš„é›†åˆ |
| `Set<Map.Entry<K,V>> entrySet()` | è¿”å›é”®å€¼å¯¹çš„é›†åˆ |

```java
HashMap<String, Integer> map = new HashMap<>();
map.put("Java", 1);
map.put("Python", 2);
System.out.println(map.get("Java")); // è¾“å‡º 1
System.out.println(map.containsKey("Python")); // true
```


### âœ… `LinkedHashMap`ï¼šä¿ç•™æ’å…¥é¡ºåºçš„ Map

#### ç‰¹ç‚¹ï¼š
- ç»§æ‰¿è‡ª `HashMap`
- ä½¿ç”¨åŒå‘é“¾è¡¨ç»´æŠ¤æ’å…¥é¡ºåº
- æ’å…¥æ€§èƒ½ç•¥ä½äº `HashMap`

#### å¸¸ç”¨æ–¹æ³•ä¸ç¤ºä¾‹ï¼š

| æ–¹æ³• | æè¿° |
|------|------|
| `Iterator<Map.Entry<K,V>> entrySet()` | æŒ‰æ’å…¥é¡ºåºéå†é”®å€¼å¯¹ |

```java
LinkedHashMap<String, Integer> map = new LinkedHashMap<>();
map.put("A", 1);
map.put("B", 2);
for (Map.Entry<String, Integer> entry : map.entrySet()) {
    System.out.println(entry.getKey() + ": " + entry.getValue());
}
// è¾“å‡ºï¼š
// A: 1
// B: 2
```


### âœ… `TreeMap`ï¼šåŸºäºçº¢é»‘æ ‘çš„æœ‰åº Map

#### ç‰¹ç‚¹ï¼š
- æŒ‰é”®æ’åºï¼ˆè‡ªç„¶é¡ºåºæˆ–è‡ªå®šä¹‰é¡ºåºï¼‰
- æ’å…¥ã€æŸ¥æ‰¾ã€åˆ é™¤æ—¶é—´å¤æ‚åº¦ä¸º O(log n)
- é”®ä¸èƒ½ä¸º null

#### å¸¸ç”¨æ–¹æ³•ä¸ç¤ºä¾‹ï¼š

| æ–¹æ³• | æè¿° |
|------|------|
| `Map.Entry<K,V> firstEntry()` | è¿”å›ç¬¬ä¸€ä¸ªï¼ˆæœ€å°é”®ï¼‰é”®å€¼å¯¹ |
| `Map.Entry<K,V> lastEntry()` | è¿”å›æœ€åä¸€ä¸ªï¼ˆæœ€å¤§é”®ï¼‰é”®å€¼å¯¹ |
| `NavigableMap<K,V> descendingMap()` | è¿”å›é€†åºçš„ Map è§†å›¾ |

```java
TreeMap<String, Integer> map = new TreeMap<>();
map.put("Java", 1);
map.put("C++", 2);
map.put("Python", 3);

System.out.println(map.firstEntry()); // è¾“å‡º C++=2
System.out.println(map.descendingMap()); // è¾“å‡º {Python=3, Java=1, C++=2}
```


### âœ… `Hashtable`ï¼šæ—©æœŸçº¿ç¨‹å®‰å…¨ç‰ˆæœ¬çš„ Map

#### ç‰¹ç‚¹ï¼š
- é”®å’Œå€¼éƒ½ä¸èƒ½ä¸º null
- çº¿ç¨‹å®‰å…¨ï¼ˆsynchronizedï¼‰
- å·²è¢« `ConcurrentHashMap` æ›¿ä»£ï¼Œä½†ä»å¸¸è§äºè€é¡¹ç›®

#### å¸¸ç”¨æ–¹æ³•ä¸ç¤ºä¾‹ï¼š

| æ–¹æ³• | æè¿° |
|------|------|
| `Enumeration<K> keys()` | è¿”å›æ‰€æœ‰é”®çš„æšä¸¾ |
| `Enumeration<V> elements()` | è¿”å›æ‰€æœ‰å€¼çš„æšä¸¾ |

```java
import java.util.*;

Hashtable<String, String> table = new Hashtable<>();
table.put("name", "Tom");
System.out.println(table.get("name"));

Enumeration<String> keys = table.keys();
while (keys.hasMoreElements()) {
    String key = keys.nextElement();
    System.out.println(key + ": " + table.get(key));
}
```


### âœ… `Properties`: æŒä¹…çš„å±æ€§é›†

#### ç‰¹ç‚¹ï¼š
- ç»§æ‰¿è‡ª `Hashtable`ï¼Œå› æ­¤ä¹Ÿæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚
- é”®å’Œå€¼é€šå¸¸éƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹ã€‚
- ä¸»è¦ç”¨äºè¯»å†™é…ç½®æ–‡ä»¶ï¼ˆ.properties æ–‡ä»¶ï¼‰ã€‚
- å¯ä»¥ä»è¾“å…¥/è¾“å‡ºæµåŠ è½½å’Œå­˜å‚¨å±æ€§ã€‚

#### å¸¸ç”¨æ–¹æ³•ä¸ç¤ºä¾‹ï¼š

| æ–¹æ³• | æè¿° |
|------|------|
| `String getProperty(String key)` | è·å–æŒ‡å®šé”®çš„å±æ€§å€¼ |
| `String getProperty(String key, String defaultValue)` | è·å–æŒ‡å®šé”®çš„å±æ€§å€¼ï¼Œè‹¥é”®ä¸å­˜åœ¨åˆ™è¿”å›é»˜è®¤å€¼ |
| `Object setProperty(String key, String value)` | è®¾ç½®å±æ€§é”®å€¼å¯¹ï¼ˆè¿”å›å…ˆå‰çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰åˆ™è¿”å› nullï¼‰ |
| `void load(InputStream inStream)` | ä»è¾“å…¥å­—èŠ‚æµåŠ è½½å±æ€§åˆ—è¡¨ |
| `void store(OutputStream out, String comments)` | å°†å±æ€§åˆ—è¡¨å†™å…¥è¾“å‡ºå­—èŠ‚æµ |
| `void loadFromXML(InputStream in)` | ä» XML æ–‡æ¡£åŠ è½½æ‰€æœ‰å±æ€§ |
| `void storeToXML(OutputStream os, String comment)` | å°†å±æ€§åˆ—è¡¨å†™å…¥ XML æ–‡æ¡£ |

```java
import java.util.Properties;
import java.io.FileOutputStream;
import java.io.FileInputStream;
import java.io.IOException;

public class PropertiesExample {
    public static void main(String[] args) {
        Properties props = new Properties();

        // è®¾ç½®å±æ€§
        props.setProperty("database.url", "localhost");
        props.setProperty("database.user", "admin");
        props.setProperty("database.password", "secret");

        // è·å–å±æ€§
        System.out.println(props.getProperty("database.user")); // è¾“å‡º admin

        // ä¿å­˜åˆ°æ–‡ä»¶
        try (FileOutputStream fos = new FileOutputStream("config.properties")) {
            props.store(fos, "æ•°æ®åº“é…ç½®");
        } catch (IOException e) {
            e.printStackTrace();
        }

        // ä»æ–‡ä»¶åŠ è½½
        Properties loadedProps = new Properties();
        try (FileInputStream fis = new FileInputStream("config.properties")) {
            loadedProps.load(fis);
            System.out.println(loadedProps.getProperty("database.url")); // è¾“å‡º localhost
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```


## å››ã€æ€»ç»“è¡¨æ ¼ï¼ˆä¸€å¥è¯è®°å¿†ï¼‰

| ç±»å | åº•å±‚ç»“æ„ | æ˜¯å¦æœ‰åº | æ˜¯å¦çº¿ç¨‹å®‰å…¨ | æ˜¯å¦å…è®¸ null é”®/å€¼ |
|------|----------|-----------|----------------|------------------------|
| `ArrayList` | åŠ¨æ€æ•°ç»„ | âœ… | âŒ | âœ… |
| `LinkedList` | åŒå‘é“¾è¡¨ | âŒ | âŒ | âœ… |
| `HashSet` | å“ˆå¸Œè¡¨ | âŒ | âŒ | âœ… |
| `LinkedHashSet` | å“ˆå¸Œè¡¨ + é“¾è¡¨ | âœ…ï¼ˆæ’å…¥é¡ºåºï¼‰ | âŒ | âœ… |
| `TreeSet` | çº¢é»‘æ ‘ | âœ…ï¼ˆæ’åºï¼‰ | âŒ | âŒ |
| `HashMap` | å“ˆå¸Œè¡¨ | âŒ | âŒ | âœ… |
| `LinkedHashMap` | å“ˆå¸Œè¡¨ + é“¾è¡¨ | âœ…ï¼ˆæ’å…¥é¡ºåºï¼‰ | âŒ | âœ… |
| `TreeMap` | çº¢é»‘æ ‘ | âœ…ï¼ˆæŒ‰é”®æ’åºï¼‰ | âŒ | âŒ |
| `Hashtable` | å“ˆå¸Œè¡¨ | âŒ | âœ… | âŒ |
| `Properties` | å“ˆå¸Œè¡¨ | âŒ | âœ… | âŒ |


:::details æ·±å…¥è§£æï¼šJava çš„ Set æ˜¯å¦‚ä½•åˆ¤æ–­é‡å¤å…ƒç´ çš„ï¼Ÿ
## ğŸ§  æ·±å…¥è§£æï¼šJava çš„ Set æ˜¯å¦‚ä½•åˆ¤æ–­é‡å¤å…ƒç´ çš„ï¼Ÿ

Java ä¸­å¸¸è§çš„ `Set` å®ç°æœ‰ï¼š

| Set ç±»å‹ | åˆ¤æ–­é‡å¤çš„æ–¹å¼ |
|----------|----------------|
| `HashSet` | ä½¿ç”¨ `hashCode()` å’Œ `equals()` æ–¹æ³• |
| `LinkedHashSet` | åŒä¸Šï¼Œåªæ˜¯ä¿ç•™æ’å…¥é¡ºåº |
| `TreeSet` | ä½¿ç”¨ `compareTo()` æ–¹æ³•ï¼ˆåŸºäºæ’åºï¼‰ |

ä¸‹é¢æˆ‘ä»¬åˆ†åˆ«è®²è§£å®ƒä»¬å¯¹å…ƒç´ çš„è¦æ±‚ã€‚

## ğŸ” ä¸€ã€`HashSet` å’Œ `LinkedHashSet`

### âœ… è¦æ±‚ï¼š
- å…ƒç´ ç±»å¿…é¡»é‡å†™ï¼š
  - `hashCode()`
  - `equals(Object obj)`

è¿™ä¸¤ä¸ªæ–¹æ³•ç”¨äºåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦"ç›¸ç­‰"ã€‚

### âš™ï¸ åŸç†ï¼š
- `HashSet` ä½¿ç”¨å“ˆå¸Œè¡¨å­˜å‚¨å…ƒç´ ã€‚
- æ’å…¥ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œå…ˆè°ƒç”¨ `hashCode()` æ‰¾åˆ°æ¡¶çš„ä½ç½®ï¼›
- å¦‚æœå‘ç”Ÿå“ˆå¸Œå†²çªï¼Œå†ä½¿ç”¨ `equals()` æ¯”è¾ƒæ˜¯å¦çœŸçš„é‡å¤ã€‚

### âœ… ç¤ºä¾‹ï¼š

```java
class Person {
    String name;

    public Person(String name) {
        this.name = name;
    }

    // é‡å†™ equals()
    @Override
    public boolean equals(Object obj) {
        if (this == obj) return true;
        if (!(obj instanceof Person)) return false;
        Person other = (Person) obj;
        return this.name.equals(other.name);
    }

    // é‡å†™ hashCode()
    @Override
    public int hashCode() {
        return name.hashCode();
    }
}

public class Main {
    public static void main(String[] args) {
        Set<Person> set = new HashSet<>();
        Person p1 = new Person("Tom");
        Person p2 = new Person("Tom");

        set.add(p1);
        set.add(p2);

        System.out.println(set.size()); // è¾“å‡º 1ï¼Œè¯´æ˜æ˜¯åŒä¸€ä¸ªå…ƒç´ 
    }
}
```

ğŸ“Œ å¦‚æœä½ ä¸é‡å†™ `hashCode()` å’Œ `equals()`ï¼Œå³ä½¿å†…å®¹ç›¸åŒï¼Œä¹Ÿä¼šè¢«è§†ä¸ºä¸åŒå¯¹è±¡ã€‚


## ğŸ“š äºŒã€`TreeSet`

### âœ… è¦æ±‚ï¼š
- å…ƒç´ ç±»å¿…é¡»å®ç° `Comparable<T>` æ¥å£ï¼Œå¹¶é‡å†™ `compareTo()` æ–¹æ³•ï¼›
- æˆ–è€…ï¼Œåœ¨åˆ›å»º `TreeSet` æ—¶ä¼ å…¥ä¸€ä¸ªè‡ªå®šä¹‰çš„ `Comparator<T>`ã€‚

### âš™ï¸ åŸç†ï¼š
- `TreeSet` æ˜¯åŸºäºçº¢é»‘æ ‘å®ç°çš„æœ‰åºé›†åˆï¼›
- å®ƒé€šè¿‡æ¯”è¾ƒå¯¹è±¡çš„å¤§å°æ¥å†³å®šå…ƒç´ ä½ç½®å’Œå»é‡ï¼›
- å¦‚æœ `compareTo()` è¿”å› 0ï¼Œå°±è®¤ä¸ºä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ã€‚

### âœ… ç¤ºä¾‹ï¼ˆå®ç° Comparableï¼‰ï¼š

```java
class Student implements Comparable<Student> {
    String name;

    public Student(String name) {
        this.name = name;
    }

    @Override
    public int compareTo(Student other) {
        return this.name.compareTo(other.name); // æ ¹æ® name æ’åº
    }
}

public class Main {
    public static void main(String[] args) {
        Set<Student> set = new TreeSet<>();
        Student s1 = new Student("Alice");
        Student s2 = new Student("Alice");

        set.add(s1);
        set.add(s2);

        System.out.println(set.size()); // è¾“å‡º 1ï¼Œè¯´æ˜æ˜¯åŒä¸€ä¸ªå…ƒç´ 
    }
}
```

### âœ… ç¤ºä¾‹ï¼ˆä½¿ç”¨ Comparatorï¼‰ï¼š

```java
Set<Student> set = new TreeSet<>((s1, s2) -> s1.name.compareTo(s2.name));
```

### âœ… ç¤ºä¾‹ï¼ˆå®šä¹‰ Comparator å®ç°ç±»ï¼‰ï¼š

æœ‰æ—¶ï¼Œæ¯”è¾ƒé€»è¾‘æ¯”è¾ƒå¤æ‚ï¼Œæˆ–è€…æˆ‘ä»¬å¸Œæœ›åœ¨å¤šä¸ªåœ°æ–¹å¤ç”¨è¿™ä¸ªæ¯”è¾ƒå™¨ï¼Œè¿™æ—¶å¯ä»¥å®šä¹‰ä¸€ä¸ªå•ç‹¬çš„ç±»æ¥å®ç° `Comparator` æ¥å£ã€‚

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª `Student` ç±»ï¼Œé™¤äº† `name` è¿˜æœ‰ `age` å±æ€§ï¼Œæˆ‘ä»¬å¸Œæœ›æŒ‰ç…§å¹´é¾„æ¥æ’åº `Student` å¯¹è±¡ã€‚

```java
class Student { // å‡è®¾ Student ç±»å·²å®šä¹‰ï¼ŒåŒ…å« name å’Œ age
    String name;
    int age;

    public Student(String name, int age) {
        this.name = name;
        this.age = age;
    }

    @Override
    public String toString() {
        return "Student{name='" + name + "', age=" + age + "}";
    }
    // æ³¨æ„ï¼šè¿™é‡Œæˆ‘ä»¬ä¸éœ€è¦ Student å®ç° Comparable æ¥å£
    // ä¹Ÿä¸éœ€è¦é‡å†™ equals å’Œ hashCode (é™¤é HashSet/LinkedHashSet ä¹Ÿéœ€è¦ç”¨)
}

// è‡ªå®šä¹‰æ¯”è¾ƒå™¨ç±»ï¼ŒæŒ‰å¹´é¾„å‡åºæ’åº
class StudentAgeComparator implements Comparator<Student> {
    @Override
    public int compare(Student s1, Student s2) {
        // è¿”å›è´Ÿæ•´æ•°ã€é›¶æˆ–æ­£æ•´æ•°ï¼Œåˆ†åˆ«è¡¨ç¤º s1 å°äºã€ç­‰äºæˆ–å¤§äº s2
        return s1.age - s2.age;
        // å¦‚æœå¸Œæœ›é™åºï¼Œå¯ä»¥æ˜¯ s2.age - s1.age
    }
}

public class Main {
    public static void main(String[] args) {
        // åˆ›å»º TreeSet æ—¶ä¼ å…¥è‡ªå®šä¹‰æ¯”è¾ƒå™¨å®ä¾‹
        Set<Student> studentSetByAge = new TreeSet<>(new StudentAgeComparator());

        studentSetByAge.add(new Student("Alice", 20));
        studentSetByAge.add(new Student("Bob", 18));
        studentSetByAge.add(new Student("Charlie", 22));

        // å…ƒç´ å°†æŒ‰å¹´é¾„æ’åº
        for (Student s : studentSetByAge) {
            System.out.println(s);
        }
        // è¾“å‡ºï¼š
        // Student{name='Bob', age=18}
        // Student{name='Alice', age=20}
        // Student{name='Charlie', age=22}
    }
}
```

ä½¿ç”¨å•ç‹¬çš„ `Comparator` ç±»çš„å¥½å¤„ï¼š
- **å…³æ³¨ç‚¹åˆ†ç¦»**ï¼šå°†æ¯”è¾ƒé€»è¾‘ä»å…ƒç´ ç±»ä¸­åˆ†ç¦»å‡ºæ¥ã€‚
- **çµæ´»æ€§**ï¼šå¯ä»¥ä¸ºåŒä¸€ä¸ªç±»æä¾›å¤šç§ä¸åŒçš„æ’åºæ–¹å¼ã€‚
- **å¯å¤ç”¨æ€§**ï¼šæ¯”è¾ƒå™¨å¯ä»¥åœ¨éœ€è¦ç›¸åŒæ’åºé€»è¾‘çš„å¤šä¸ªåœ°æ–¹å…±äº«ã€‚


## ğŸ†š å¯¹æ¯” C++

| ç‰¹å¾ | Java | C++ |
|------|------|-----|
| æ˜¯å¦éœ€è¦é‡å†™æ–¹æ³•/æ¥å£ | âœ… éœ€è¦ï¼ˆhashCode/equals æˆ– Comparableï¼‰ | âœ… éœ€è¦ï¼ˆå¦‚ operator<ã€operator==ï¼‰ |
| é»˜è®¤å»é‡ä¾æ® | `hashCode()` + `equals()` | `operator==()` |
| é»˜è®¤æ’åºä¾æ® | âŒï¼ˆHashSetï¼‰ / `compareTo()`ï¼ˆTreeSetï¼‰ | `operator<()` |
| æ˜¯å¦æ”¯æŒå‡½æ•°å¯¹è±¡è‡ªå®šä¹‰æ¯”è¾ƒå™¨ | âœ…ï¼ˆComparatorï¼‰ | âœ…ï¼ˆä»¿å‡½æ•°ï¼‰ |


## ğŸ§© æ€»ç»“ä¸€å¥è¯ï¼š

> **Java ä¸­çš„ `Set` ä¸åƒ C++ é‚£æ ·éœ€è¦é‡è½½è¿ç®—ç¬¦ï¼Œä½†ä¸ºäº†æ­£ç¡®åˆ¤æ–­å…ƒç´ æ˜¯å¦é‡å¤æˆ–è¿›è¡Œæ’åºï¼Œä½ éœ€è¦ä¸ºè‡ªå®šä¹‰ç±»é‡å†™ç›¸åº”çš„æ–¹æ³•ï¼š**
> - `HashSet`ï¼šé‡å†™ `hashCode()` å’Œ `equals()`
> - `TreeSet`ï¼šå®ç° `Comparable` æˆ–æä¾› `Comparator`

:::


:::details ä¸ºä»€ä¹ˆ `compareTo(Student other)` çš„å‚æ•°ä¸æ˜¯ `Object`ï¼Œè€Œ `equals(Object obj)` æ˜¯ï¼Ÿ
è¿™ä¸ªé—®é¢˜éå¸¸æœ‰æ·±åº¦ï¼Œå®ƒè§¦åŠåˆ°äº† Java ä¸­ä¸¤ä¸ªé‡è¦çš„é¢å‘å¯¹è±¡ç‰¹æ€§ï¼š

- **æ¥å£è®¾è®¡**
- **ç±»å‹å®‰å…¨ï¼ˆType Safetyï¼‰**

æˆ‘ä»¬æ¥ä¸€æ­¥ä¸€æ­¥åœ°è§£é‡Šæ¸…æ¥šã€‚


## âœ… ç®€å•å›ç­”ï¼š

**å› ä¸º `compareTo()` æ˜¯å®šä¹‰åœ¨ `Comparable<T>` æ¥å£é‡Œçš„æ–¹æ³•ï¼Œå®ƒçš„æ³›å‹ç‰ˆæœ¬ç›´æ¥æŒ‡å®šäº†æ¯”è¾ƒçš„å¯¹è±¡ç±»å‹ï¼Œæ‰€ä»¥ä¸éœ€è¦ç”¨ `Object`ã€‚è€Œ `equals()` æ˜¯å®šä¹‰åœ¨ `Object` ç±»ä¸­çš„æ–¹æ³•ï¼Œå¿…é¡»èƒ½æ¥å—ä»»ä½•ç±»å‹çš„å¯¹è±¡ä½œä¸ºå‚æ•°ã€‚**


## ğŸ§  æ·±å…¥è®²è§£ï¼šJava ä¸­çš„ä¸¤ä¸ªæ–¹æ³•è®¾è®¡å·®å¼‚

| æ–¹æ³• | æ‰€å± | å‚æ•°ç±»å‹ | æ˜¯å¦æ³›å‹ | è®¾è®¡ç›®çš„ |
|------|------|-----------|------------|-------------|
| `boolean equals(Object obj)` | `Object` ç±» | `Object` | âŒ ä¸æ˜¯æ³›å‹ | åˆ¤æ–­ä»»æ„å¯¹è±¡æ˜¯å¦ç›¸ç­‰ |
| `int compareTo(T o)`         | `Comparable<T>` æ¥å£ | `T`        | âœ… æ˜¯æ³›å‹ | æ¯”è¾ƒå½“å‰å¯¹è±¡ä¸æŒ‡å®šç±»å‹å¯¹è±¡çš„å¤§å°å…³ç³» |

### 1. `equals()` æ¥è‡ª `Object`
```java
public boolean equals(Object obj) {
    return (this == obj);
}
```

è¿™æ˜¯æ‰€æœ‰ç±»çš„çˆ¶ç±»æ–¹æ³•ï¼Œå› æ­¤å¿…é¡»æ¥æ”¶ `Object` ç±»å‹ï¼Œæ‰èƒ½æ”¯æŒä»»ä½•å¯¹è±¡ä¹‹é—´çš„æ¯”è¾ƒã€‚

#### ç¤ºä¾‹ï¼š
```java
Object a = "hello";
Object b = new Integer(123);

a.equals(b); // åˆæ³•ï¼Œè™½ç„¶è¿”å› false
```

ä¸ºäº†ä¿è¯å…¼å®¹æ€§ï¼ŒJava ä¸å¾—ä¸åœ¨ `equals()` ä¸­ä½¿ç”¨ `Object` å‚æ•°ã€‚


### 2. `compareTo()` æ¥è‡ª `Comparable<T>` æ¥å£ï¼ˆæ³›å‹æ¥å£ï¼‰

```java
public interface Comparable<T> {
    public int compareTo(T o);
}
```

è¿™æ˜¯ä¸€ä¸ª**æ³›å‹æ¥å£**ï¼Œä½ å¯ä»¥æŒ‡å®šè¦æ¯”è¾ƒçš„å¯¹è±¡ç±»å‹ã€‚

#### ä½ çš„ä»£ç ï¼š
```java
class Student implements Comparable<Student> {
    String name;

    @Override
    public int compareTo(Student other) {
        return this.name.compareTo(other.name);
    }
}
```

è¿™é‡Œ `Student` å®ç°äº† `Comparable<Student>`ï¼Œè¯´æ˜å®ƒåªèƒ½å’Œå¦ä¸€ä¸ª `Student` å¯¹è±¡è¿›è¡Œæ¯”è¾ƒã€‚

è¿™æ ·åšæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ


## âœ… å¥½å¤„ä¸€ï¼šç±»å‹å®‰å…¨ï¼ˆType Safetyï¼‰

ä½¿ç”¨æ³›å‹åï¼Œç¼–è¯‘å™¨å¯ä»¥ç¡®ä¿ä½ ä¼ å…¥çš„æ˜¯æ­£ç¡®çš„ç±»å‹ã€‚

```java
TreeSet<Student> students = new TreeSet<>();
students.add(new Student("Tom"));
students.add(new Student("Jerry"));

// åªèƒ½æ·»åŠ  Student ç±»å‹ï¼Œä¸èƒ½æ·»åŠ  String æˆ–å…¶ä»–ç±»å‹
students.add("Hello"); // âŒ ç¼–è¯‘é”™è¯¯ï¼
```

å¦‚æœ `compareTo()` ç”¨çš„æ˜¯ `Object`ï¼Œå°±æ— æ³•åšåˆ°è¿™ç§ç¼–è¯‘æœŸæ£€æŸ¥ã€‚


## âœ… å¥½å¤„äºŒï¼šé¿å…å¼ºåˆ¶ç±»å‹è½¬æ¢

å¦‚æœä½ ç”¨ `Object` ä½œä¸ºå‚æ•°ï¼Œä½ éœ€è¦æ‰‹åŠ¨å¼ºè½¬ï¼š

```java
@Override
public int compareTo(Object obj) {
    Student other = (Student) obj;
    return this.name.compareTo(other.name);
}
```

è¿™æ ·ä¸ä»…ä¸å®‰å…¨ï¼ˆå¯èƒ½æŠ›å‡º `ClassCastException`ï¼‰ï¼Œè€Œä¸”ä¸å¤Ÿä¼˜é›…ã€‚

è€Œä½¿ç”¨æ³›å‹åï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ `Student` ç±»å‹ï¼Œæ— éœ€å¼ºè½¬ã€‚


## ğŸ” æ€»ç»“å¯¹æ¯”è¡¨

| ç‰¹å¾ | `equals(Object obj)` | `compareTo(T o)` |
|------|------------------------|------------------|
| å®šä¹‰ä½ç½® | `Object` ç±» | `Comparable<T>` æ¥å£ |
| å‚æ•°ç±»å‹ | `Object` | æ³›å‹ `T` |
| æ˜¯å¦éœ€è¦å¼ºè½¬ | âœ… éœ€è¦ | âŒ ä¸éœ€è¦ |
| æ˜¯å¦ç±»å‹å®‰å…¨ | âŒ ä¸å¤Ÿå®‰å…¨ | âœ… å®‰å…¨ |
| ä½¿ç”¨åœºæ™¯ | åˆ¤æ–­ç›¸ç­‰ | åˆ¤æ–­é¡ºåº/æ’åº |
| å¤šæ€æ”¯æŒ | âœ… æ”¯æŒä»»æ„å¯¹è±¡ | âœ… æ”¯æŒæ³›å‹åŒ¹é…å¯¹è±¡ |


## ğŸ“ æ€»ç»“ä¸€å¥è¯ï¼š

> `equals()` ç”¨ `Object` æ˜¯ä¸ºäº†å…¼å®¹æ‰€æœ‰å¯¹è±¡ï¼Œè€Œ `compareTo()` ç”¨æ³›å‹ `T` æ˜¯ä¸ºäº†ç±»å‹å®‰å…¨å’Œé¿å…å¼ºè½¬ã€‚å®ƒä»¬çš„è®¾è®¡ä½“ç°äº† Java åœ¨é€šç”¨æ€§å’Œå®‰å…¨æ€§ä¹‹é—´çš„æƒè¡¡ã€‚


## ğŸ§© è¿›é˜¶å»ºè®®ï¼ˆå¯é€‰ï¼‰

å¦‚æœä½ æƒ³è¿›ä¸€æ­¥ç†è§£è¿™äº›æœºåˆ¶ï¼Œæˆ‘å¯ä»¥ç»§ç»­è®²ï¼š

- `Comparator<T>` å’Œ `Comparable<T>` çš„åŒºåˆ«ï¼Ÿ
- Java ä¸­çš„æ³›å‹æ“¦é™¤ï¼ˆType Erasureï¼‰åŸç†ï¼Ÿ
- å¦‚ä½•è‡ªå®šä¹‰æ’åºè§„åˆ™å¹¶ç”¨äº `TreeSet` æˆ– `Collections.sort()`ï¼Ÿ
- Java 8+ ä¸­ `Comparator.comparing()` çš„ä½¿ç”¨æŠ€å·§ï¼Ÿ

æ¬¢è¿ç»§ç»­æé—® ğŸ˜Š
:::
